{"version":3,"file":"ejunior95-formai-angular.mjs","sources":["../../src/lib/ai-form.service.ts","../../src/index.ts","../../src/ejunior95-formai-angular.ts"],"sourcesContent":["import { Injectable, signal } from '@angular/core';\nimport {\n  getFieldConfig,\n  validateValue,\n  type FormAIConfig,\n  type FormAIOptions\n} from '@ejunior95/formai-core';\n\n/**\n * Nota: @Injectable() sem 'providedIn'\n * * Não estamos usando 'providedIn: \"root\"'.\n * Queremos que este serviço funcione como o hook do React,\n * onde cada componente que o utiliza obtém sua PRÓPRIA instância.\n * * O usuário deverá fornecer este serviço no 'providers' do componente.\n */\n@Injectable()\nexport class AiFormService {\n\n  // --- Gerenciamento de Estado com Signals ---\n  // Signals são o equivalente moderno do Angular ao useState do React.\n  // Eles notificam automaticamente qualquer parte da UI que os esteja \"ouvindo\".\n\n  /** O valor atual do campo (controlado pelo serviço) */\n  public readonly value = signal<string>(\"\");\n\n  /** O erro de validação atual */\n  public readonly error = signal<string | null>(null);\n\n  /** A configuração do campo (ex: type, placeholder) vinda da IA */\n  public readonly config = signal<FormAIConfig | null>(null);\n\n  /** O estado de carregamento da chamada inicial à IA */\n  public readonly loading = signal<boolean>(true);\n\n\n  constructor() { }\n\n  /**\n   * Busca a configuração da IA e inicializa o serviço.\n   * Deve ser chamado no 'ngOnInit' do componente.\n   */\n  public async initialize(userPrompt: string, options?: FormAIOptions): Promise<void> {\n    this.loading.set(true);\n    this.error.set(null); // Limpa erros anteriores\n    \n    try {\n      const fieldConfig = await getFieldConfig(userPrompt, options);\n      this.config.set(fieldConfig);\n    } catch (e: any) {\n      console.error(\"Erro no AiFormService:\", e);\n      this.error.set(\"Falha ao gerar o campo de IA.\");\n    } finally {\n      this.loading.set(false);\n    }\n  }\n\n  /**\n   * Atualiza o valor do campo.\n   * Deve ser chamado no evento (input) do <input>.\n   */\n  public setValue(newValue: string): void {\n    this.value.set(newValue);\n  }\n\n  /**\n   * Valida o valor atual com base na configuração da IA.\n   * Deve ser chamado no evento (blur) do <input>.\n   */\n  public validate(): void {\n    const currentConfig = this.config(); // Lê o valor do signal\n    if (!currentConfig) {\n      return; // Ainda não há configuração, não pode validar\n    }\n\n    const currentValue = this.value(); // Lê o valor do signal\n    const errorMessage = validateValue(currentValue, currentConfig);\n    this.error.set(errorMessage);\n  }\n}","// Exporta o serviço principal\nexport { AiFormService } from './lib/ai-form.service';\n\n// Re-exporta os tipos do core para conveniência do usuário\nexport { \n  type FormAIConfig, \n  type FormAIOptions \n} from '@ejunior95/formai-core';","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;;AAQA;;;;;;AAMG;MAEU,aAAa,CAAA;;;;;AAOR,IAAA,KAAK,GAAG,MAAM,CAAS,EAAE,CAAC;;AAG1B,IAAA,KAAK,GAAG,MAAM,CAAgB,IAAI,CAAC;;AAGnC,IAAA,MAAM,GAAG,MAAM,CAAsB,IAAI,CAAC;;AAG1C,IAAA,OAAO,GAAG,MAAM,CAAU,IAAI,CAAC;AAG/C,IAAA,WAAA,GAAA,EAAgB;AAEhB;;;AAGG;AACI,IAAA,MAAM,UAAU,CAAC,UAAkB,EAAE,OAAuB,EAAA;AACjE,QAAA,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC;QACtB,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AAErB,QAAA,IAAI;YACF,MAAM,WAAW,GAAG,MAAM,cAAc,CAAC,UAAU,EAAE,OAAO,CAAC;AAC7D,YAAA,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC;QAC9B;QAAE,OAAO,CAAM,EAAE;AACf,YAAA,OAAO,CAAC,KAAK,CAAC,wBAAwB,EAAE,CAAC,CAAC;AAC1C,YAAA,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,+BAA+B,CAAC;QACjD;gBAAU;AACR,YAAA,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC;QACzB;IACF;AAEA;;;AAGG;AACI,IAAA,QAAQ,CAAC,QAAgB,EAAA;AAC9B,QAAA,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC;IAC1B;AAEA;;;AAGG;IACI,QAAQ,GAAA;QACb,MAAM,aAAa,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QACpC,IAAI,CAAC,aAAa,EAAE;AAClB,YAAA,OAAO;QACT;QAEA,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC;QAClC,MAAM,YAAY,GAAG,aAAa,CAAC,YAAY,EAAE,aAAa,CAAC;AAC/D,QAAA,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC;IAC9B;wGA7DW,aAAa,EAAA,IAAA,EAAA,EAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA;4GAAb,aAAa,EAAA,CAAA;;4FAAb,aAAa,EAAA,UAAA,EAAA,CAAA;kBADzB;;;ACfD;;ACAA;;AAEG;;;;"}